{
    "version": 2,
    "inquiries": [
        {
            "id": "zjjDwB2jOYs67vogZZFUY",
            "query": "-- Aggregation Section (1hr Mark) \n\n-- SUM(..) adds the whole column \n-- COUNT(*) counts how many rows\nSELECT\n\tSUM(salary_year_avg) as salary_sum, \n    COUNT(*) AS count_rows\nFROM\n\tjob_postings_fact;\n    \nSELECT\n\tCOUNT(DISTINCT job_title_short) AS job_type_total\nFROM\n\tjob_postings_fact;\n-- Counts how many unique jobs \n\nSELECT\n\tjob_title_short AS jobs,\n    COUNT(job_title_short) AS job_count, \n\tAVG(salary_year_avg) AS salary_avg, \n    MIN(salary_year_avg) AS salary_min,\n    MAX(salary_year_avg) AS salary_max\nFROM\n\tjob_postings_fact\nGROUP BY\n\tjob_title_short\nHAVING\n\tCOUNT(job_title_short) > 100\nORDER BY\n\tsalary_avg;\n\n-- Practice Problem 1 (1hr 6 min mark)\nSELECT\n\t(SUM(salary_year_avg) / COUNT(salary_year_avg)) AS avg_yearly_salary_remote\nFROM\n\tjob_postings_fact\nWHERE\n\t(job_work_from_home = TRUE) AND (salary_year_avg IS NOT NULL);\t\n\n-- Practice Problem 2\nSELECT -- COUNT(*) counts how many rows\n\tCOUNT(*) AS total_jobs_with_health_insurance\nFROM\n\tjob_postings_fact\nWHERE\n\tjob_health_insurance = TRUE;\n    \n-- Practice Problem 3\nSELECT\n\tjob_country,\n    COUNT(job_id) AS num_job_postings\nFROM\n\tjob_postings_fact\nGROUP BY\n\tjob_country;\n \n-- NULL values \nSELECT\n\tjob_title_short, \n    job_location,\n    job_via,\n    salary_year_avg\nFROM\n\tjob_postings_fact\nWHERE\n\tsalary_year_avg IS NOT NULL\nORDER BY\n\tsalary_year_avg;\n\n-- Practice Problem 1\nSELECT\n\tskill_id, \n    skills\nFROM\n\tskills_dim\nWHERE\n\ttype IS NULL;\n-- reproduces nothing thus no type is null in data \n\n-- Practice Problem 2 \nSELECT\n\tjob_id, job_title, salary_year_avg, salary_hour_avg\nFROM\n\tjob_postings_fact\nWHERE\n\tsalary_year_avg IS NULL AND salary_hour_avg IS NULL;\n\n-- JOIN Tables \nSELECT\n\tjob_postings.job_id,\n    job_postings.job_title_short AS title, \n    companies.name AS company\nFROM job_postings_fact AS job_postings \nLEFT JOIN company_dim AS companies \n\tON job_postings.company_id = companies.company_id;\n-- LEFT JOIN joins anything from left table and stuff that is in left and right table. \n\nSELECT\n\tjob_postings.job_id,\n    job_postings.job_title_short AS title, \n    companies.name AS company\nFROM job_postings_fact AS job_postings \nRIGHT JOIN company_dim AS companies \n\tON job_postings.company_id = companies.company_id;\n-- RIGHT JOIN joins anything from right table and stuff that is in left and right table. \n\nSELECT\n\tjob_postings.job_id,\n    job_postings.job_title, \n    skills_to_job.skill_id,\n    skills.skills\nFROM \n\tjob_postings_fact AS job_postings \nINNER JOIN skills_job_dim AS skills_to_job ON job_postings.job_id = skills_to_job.job_id\nINNER JOIN skills_dim AS skills ON skills_to_job.skill_id = skills.skill_id;\n-- INNER JOIN joins that is in both left and right table \n-- FULL OUTER JOIN joins everything from both tables (not really useful)\n\n-- Practice Problem 1 (1hr 20 min mark)\nSELECT\n\tjob_postings.job_title, companies.name\nFROM\n\tjob_postings_fact AS job_postings\nJOIN\n\tcompany_dim AS companies \n    ON job_postings.company_id = companies.company_id\nWHERE\n\tjob_postings.job_title LIKE '%Data Scientist%';\n    \n-- Practice Problem 2 \nSELECT\n\tjob_postings.job_title,\n    job_postings.job_location,\n    job_postings.job_health_insurance,\n    skills.skills\nFROM\n\tjob_postings_fact AS job_postings \nLEFT JOIN\n\tskills_job_dim AS skills_to_job ON job_postings.job_id = skills_to_job.job_id\nLEFT JOIN\n\tskills_dim AS skills ON skills_to_job.skill_id = skills.skill_id\nWHERE\n\tjob_postings.job_location = 'New York'\n    AND job_postings.job_health_insurance = TRUE;\n/*\nFirst LEFT JOIN compare to job_postings but second do it skills_to_job as thats \nthe result after running the First LEFT JOIN\n*/\n\n/* \nPractice Problem 5 (1hr 23 min) \n- Write a query to list each unique skill from skill_dim table \n- Count how many job postings mention each skill from the skills_to_job_dim table\n- Calculate the average yearly salary for job postings associated with each skill\n- Group the results by the skill name\n- Order by the average salary\n*/ \nSELECT\n\tskills.skills AS skill_name,\n    COUNT(skills_to_job.job_id) AS number_of_job_postings,\n    AVG(job_postings.salary_year_avg) AS average_salary_for_skill\nFROM\n\tskills_dim AS skills \nLEFT JOIN skills_job_dim AS skills_to_job ON skills.skill_id = skills_to_job.skill_id\nLEFT JOIN job_postings_fact AS job_postings ON skills_to_job.job_id = job_postings.job_id\nGROUP BY\n\tskills.skills\nORDER BY\n\taverage_salary_for_skill DESC\n\t\n",
            "viewType": "chart",
            "viewOptions": {
                "data": [],
                "layout": {
                    "autosize": true,
                    "xaxis": {
                        "range": [
                            -1,
                            6
                        ],
                        "autorange": true
                    },
                    "yaxis": {
                        "range": [
                            -1,
                            4
                        ],
                        "autorange": true
                    }
                },
                "frames": []
            },
            "name": "Basic_Section_4",
            "updatedAt": "2026-01-02T17:10:20.339Z",
            "createdAt": "2026-01-01T20:24:39.756Z"
        }
    ]
}